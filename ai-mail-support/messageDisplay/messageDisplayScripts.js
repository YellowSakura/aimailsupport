(()=>{class e{createBarChart(e,t=null){let n=document.createElement("div");n.id="chart";let a=Object.keys(e),s=Object.values(e);for(let e=0;e<a.length;++e){let r=document.createElement("div");r.classList.add("row");let o=document.createElement("div");o.classList.add("label"),o.innerText=a[e];let d=document.createElement("div");d.classList.add("bar-wrapper"),d.setAttribute("data-value",`${s[e]}%`);let c=document.createElement("div");c.classList.add("bar"),c.style.width=`${s[e]}%`,null!=t&&s[e]>=t&&c.classList.add("unsafe-value"),d.appendChild(c),r.appendChild(o),r.appendChild(d),n.appendChild(r)}return n}}function t(){return document.querySelector("#amsOuterResponse")?.shadowRoot?.querySelector("#amsInnerResponse")}function n(e=!1){if(e)return void document.querySelector("#amsOuterResponse").remove();document.querySelector("#amsOuterResponse").classList.contains("show")||document.querySelector("#amsOuterResponse").classList.add("show"),t().classList.remove("error"),t().classList.remove("thinking"),t().querySelector("#amsContent").innerHTML=""}(async()=>{browser.runtime.onMessage.addListener(async a=>{var s,r,o;if(a?.type)switch(function(){if(document.querySelector("#amsOuterResponse"))return;let e=document.createElement("div");e.id="amsOuterResponse";let t=e.attachShadow({mode:"open"}),a=document.createElement("div");a.id="amsInnerResponse",t.appendChild(a);let s=document.createElement("link");s.rel="stylesheet",s.href=browser.runtime.getURL("/messageDisplay/messageDisplayScripts.css"),a.appendChild(s);let r=document.createElement("img");r.id="amsImage",r.src=browser.runtime.getURL("/images/bot-icon-color-64.webp"),a.appendChild(r);let o=document.createElement("div");o.id="amsContent",a.appendChild(o);let d=document.createElement("span");d.className="close-icon",d.innerHTML="&times;",d.addEventListener("click",()=>n(!0)),a.appendChild(d),document.body.appendChild(e)}(),a.type){case"addAudio":!function(e){n();let a=new FileReader;a.onload=()=>{let e=a.result,n=document.createElement("audio");n.src=e,n.autoplay=!0,n.controls=!0,t().querySelector("#amsContent").appendChild(n)},a.readAsDataURL(e)}(a.content);break;case"addChart":!function(a){n();let s=new e;t().querySelector("#amsContent").append(s.createBarChart(a,50))}(a.content);break;case"addText":s=a.content,n(),t().querySelector("#amsContent").textContent=s;break;case"showError":r=a.content,n(),t().classList.add("error"),t().querySelector("#amsContent").textContent=r;break;case"thinking":o=a.content,n(),t().classList.add("thinking"),t().querySelector("#amsContent").innerHTML=`${o}<span class="dots"></span>`}})})()})();