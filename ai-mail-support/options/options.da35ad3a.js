function e(e,t,a,o){Object.defineProperty(e,t,{get:a,set:o,enumerable:!0,configurable:!0})}var t=globalThis,a={},o={},r=t.parcelRequire693b;null==r&&((r=function(e){if(e in a)return a[e].exports;if(e in o){var t=o[e];delete o[e];var r={id:e,exports:{}};return a[e]=r,t.call(r.exports,r,r.exports),r.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){o[e]=t},t.parcelRequire693b=r);var s=r.register;s("9v09t",function(t,a){async function o(e){let t=null;try{t=(await browser.storage.sync.get(e))[e]}catch(t){g(`An error occurred while retrieving the config for ${e}: ${t}`,"error")}return t}async function r(){let e=null;try{e=await browser.storage.sync.get(null)}catch(e){g(`An error occurred while retrieving configs: ${e}`,"error")}return e}function s(e,t="en"){let a=new Intl.DisplayNames([t],{type:"language"});try{return a.of(e)}catch(e){g(`Error in retrieving the language name from the code: ${e}`,"error");return}}function n(){document.querySelectorAll("[data-l10n-ref]").forEach(e=>{let t=e.getAttribute("data-l10n-ref");e.innerHTML=messenger.i18n.getMessage(t)})}async function g(e,t="log"){!0===await o("debugMode")&&console[t](`AI Mail Support: ${e}`)}e(t.exports,"getConfig",()=>o),e(t.exports,"logMessage",()=>g),e(t.exports,"getConfigs",()=>r),e(t.exports,"getLanguageNameFromCode",()=>s),e(t.exports,"localizeNodes",()=>n)}),s("hYzqD",function(t,a){e(t.exports,"GroqProvider",()=>n);var o=r("ifZGS"),s=r("9v09t");class n extends o.GenericProvider{temperature;apiKey;model;constructor(e){super(e),this.temperature=e.temperature,this.apiKey=e.groq.apiKey,this.model=e.groq.model}async analyzeTextIntent(e){return(0,s.logMessage)(`Request to analyze text intent of ${e} in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,s.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,s.logMessage)(`Request to explain in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}static async getModels(e){let t={method:"GET",redirect:"follow",headers:new Headers({Authorization:`Bearer ${e}`})},a=await fetch("https://api.groq.com/openai/v1/models",t);if(!a.ok){let e=await a.json();throw Error(`Groq error: ${e.error.message}`)}return(await a.json()).data.map(e=>e.id)}async rephraseText(e,t){return(0,s.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,s.logMessage)(`Request suggest improvements in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,s.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,s.logMessage)(`Request to summarize in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e} in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,s.logMessage)(`Request to translate in ${(0,s.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,s.getLanguageNameFromCode)(t)),e)}getHeader(){let e=new Headers;return e.append("Authorization",`Bearer ${this.apiKey}`),e.append("Content-Type","application/json"),e}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=JSON.stringify({model:this.model,messages:[{role:"system",content:e},{role:"user",content:t}],temperature:this.temperature}),s={method:"POST",headers:this.getHeader(),body:r,redirect:"follow",signal:a},n=await fetch("https://api.groq.com/openai/v1/chat/completions",s);if(o(),!n.ok){let e=await n.json();throw Error(`Groq error: ${e.error.message}`)}return(await n.json()).choices[0].message.content}}}),s("ifZGS",function(t,a){e(t.exports,"GenericProvider",()=>o);class o{mainUserLanguageCode;servicesTimeout;PROMPTS={ANALYZE_INTENT:"You are an assistant that analyzes the tone and perceived intent of an email and provides the analysis in %language%; describe how the email might come across to the recipient, considering tone, clarity, potential emotional impact, and coherence with the context of the email thread history; Ignore formatting, headers, footers, signatures, quoted replies and unusual characters",EXPLAIN:"You are an assistant that explains the content of emails in %language% in a clear and simple way, preserving the original meaning; avoid unnecessary complexity; Ignore formatting, headers, footers, signatures, quoted replies and unusual characters",REPHRASE:"You are an assistant that rephrases the content of emails in %language% using a %toneOfVoice% tone of voice; preserve the original meaning; Ignore formatting, headers, footers, signatures, quoted replies and unusual characters",SUGGEST_IMPROVEMENTS:"You are an assistant that suggests improvements to the content of emails in %language%, focusing on clarity, tone, and effectiveness; Ignore formatting, headers, footers, signatures, quoted replies and unusual characters",SUGGEST_REPLY:"You are an assistant that suggests a reply to the email in %language%, using a %toneOfVoice% tone of voice; ensure the reply is clear and relevant to the sender’s message; Ignore formatting, headers, footers, signatures, quoted replies and unusual characters",SUMMARIZE:"You are an assistant that summarizes emails in %language% in a short and clear way, focusing only on the sender’s core message or request; Ignore formatting, headers, footers, signatures, quoted replies and unusual characters",TRANSLATE:"You are an assistant that translates emails into %language% as naturally and accurately as possible; preserve meaning, tone, and style; Ignore formatting, headers, footers, signatures, quoted replies and unusual characters"};constructor(e){this.mainUserLanguageCode=e.mainUserLanguageCode,this.servicesTimeout=e.servicesTimeout}async analyzeTextIntent(e){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async applyCustomPrompt(e,t){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async explainText(e){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async getSpeechFromText(e){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async moderateText(e){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async rephraseText(e,t){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async suggestImprovementsForText(e){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async suggestReplyFromText(e,t){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async summarizeText(e){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async testIntegration(){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}async translateText(e,t=null){throw Error(browser.i18n.getMessage("errorInvalidAddonOptions"))}canAnalyzeTextIntent(){return this.analyzeTextIntent!==o.prototype.analyzeTextIntent}canApplyCustomPrompt(){return this.applyCustomPrompt!==o.prototype.applyCustomPrompt}canExplainText(){return this.explainText!==o.prototype.explainText}canModerateText(){return this.moderateText!==o.prototype.moderateText}canRephraseText(){return this.rephraseText!==o.prototype.rephraseText}canSpeechFromText(){return this.getSpeechFromText!==o.prototype.getSpeechFromText}canSuggestImprovementsForText(){return this.suggestImprovementsForText!==o.prototype.suggestImprovementsForText}canSuggestReply(){return this.suggestReplyFromText!==o.prototype.suggestReplyFromText}canSummarizeText(){return this.summarizeText!==o.prototype.summarizeText}canTranslateText(){return this.translateText!==o.prototype.translateText}createAbortSignalWithTimeout(e){let t=new AbortController,a=setTimeout(()=>t.abort(),1e3*e);return{signal:t.signal,clearAbortSignalWithTimeout:function(){clearTimeout(a)}}}}}),s("jYACc",function(t,a){e(t.exports,"LmsProvider",()=>n);var o=r("ifZGS"),s=r("9v09t");class n extends o.GenericProvider{temperature;serviceUrl;model;constructor(e){super(e),this.temperature=e.temperature,this.serviceUrl=e.lms.serviceUrl,this.model=e.lms.model}async analyzeTextIntent(e){return(0,s.logMessage)(`Request to analyze text intent of ${e} in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,s.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,s.logMessage)(`Request to explain in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}static async getModels(e){let t=await fetch(`${e}/v1/models`,{method:"GET",redirect:"follow"});if(!t.ok){let e=await t.json();throw Error(`AI Studio error: ${e.error.message}`)}return(await t.json()).data.map(e=>e.id)}async rephraseText(e,t){return(0,s.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,s.logMessage)(`Request suggest improvements in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,s.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,s.logMessage)(`Request to summarize in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e} in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,s.logMessage)(`Request to translate in ${(0,s.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,s.getLanguageNameFromCode)(t)),e)}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=new Headers;r.append("Content-Type","application/json");let s=JSON.stringify({model:this.model,messages:[{role:"system",content:e},{role:"user",content:t}],temperature:this.temperature}),n=await fetch(`${this.serviceUrl}/v1/chat/completions`,{method:"POST",headers:r,body:s,redirect:"follow",signal:a});if(o(),!n.ok){let e=await n.json();throw Error(`LM Studio error: ${e.error}`)}return(await n.json()).choices[0].message.content}}}),s("lp4zK",function(t,a){e(t.exports,"OllamaProvider",()=>n);var o=r("ifZGS"),s=r("9v09t");class n extends o.GenericProvider{temperature;serviceUrl;model;constructor(e){super(e),this.temperature=e.temperature,this.serviceUrl=e.ollama.serviceUrl,this.model=e.ollama.model}async analyzeTextIntent(e){return(0,s.logMessage)(`Request to analyze text intent of ${e} in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,s.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,s.logMessage)(`Request to explain in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}static async getModels(e){let t=await fetch(`${e}/api/tags`,{method:"GET",redirect:"follow"});if(!t.ok){let e=await t.json();throw Error(`Ollama error: ${e.error.message}`)}return(await t.json()).models.map(e=>({name:e.name,model:e.model}))}async rephraseText(e,t){return(0,s.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,s.logMessage)(`Request suggest improvements in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,s.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,s.logMessage)(`Request to summarize in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e} in ${(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE.replace("%language%",(0,s.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,s.logMessage)(`Request to translate in ${(0,s.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,s.getLanguageNameFromCode)(t)),e)}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=JSON.stringify({model:this.model,system:e,prompt:t,options:{temperature:this.temperature},stream:!1}),s=await fetch(`${this.serviceUrl}/api/generate`,{method:"POST",body:r,redirect:"follow",signal:a});if(o(),!s.ok){let e=await s.json();throw Error(`Ollama error: ${e.error}`)}return(await s.json()).response}}});var n=r("9v09t"),g=(r("ifZGS"),r("ifZGS")),n=r("9v09t");class i extends g.GenericProvider{temperature;apiKey;model;constructor(e){super(e),this.temperature=e.temperature/2,this.apiKey=e.anthropic.apiKey,this.model=e.anthropic.model}async analyzeTextIntent(e){return(0,n.logMessage)(`Request to analyze text intent of ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,n.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,n.logMessage)(`Request to explain in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async rephraseText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,n.logMessage)(`Request suggest improvements in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,n.logMessage)(`Request to summarize the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE,e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,n.logMessage)(`Request to translate in ${(0,n.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,n.getLanguageNameFromCode)(t)),e)}getHeader(){let e=new Headers;return e.append("x-api-key",this.apiKey),e.append("anthropic-version","2023-06-01"),e.append("anthropic-dangerous-direct-browser-access","true"),e.append("Content-Type","application/json"),e}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=JSON.stringify({model:this.model,temperature:this.temperature,max_tokens:2048,system:e,messages:[{role:"user",content:t}]}),s={method:"POST",headers:this.getHeader(),body:r,redirect:"follow",signal:a},n=await fetch("https://api.anthropic.com/v1/messages",s);if(o(),!n.ok){let e=await n.json();throw Error(`Anthropic error: ${e.error.message}`)}return(await n.json()).content[0].text}}var g=r("ifZGS"),n=r("9v09t");class u extends g.GenericProvider{temperature;apiKey;constructor(e){super(e),this.apiKey=e.deepseek.apiKey}async analyzeTextIntent(e){return(0,n.logMessage)(`Request to analyze text intent of ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,n.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,n.logMessage)(`Request to explain in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async rephraseText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,n.logMessage)(`Request suggest improvements in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,n.logMessage)(`Request to summarize the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE,e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,n.logMessage)(`Request to translate in ${(0,n.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,n.getLanguageNameFromCode)(t)),e)}getHeader(){let e=new Headers;return e.append("Authorization",`Bearer ${this.apiKey}`),e.append("Content-Type","application/json"),e}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=JSON.stringify({model:"deepseek-chat",messages:[{role:"system",content:e},{role:"user",content:t}],temperature:this.temperature}),s={method:"POST",headers:this.getHeader(),body:r,redirect:"follow",signal:a},n=await fetch("https://api.deepseek.com/chat/completions",s);if(o(),!n.ok){let e=await n.json();throw Error(`DeepSeek error: ${e.error.message}`)}return(await n.json()).choices[0].message.content}}var g=r("ifZGS"),n=r("9v09t");class l extends g.GenericProvider{temperature;apiKey;model;constructor(e){super(e),this.temperature=e.temperature,this.apiKey=e.google.apiKey,this.model=e.google.model}async analyzeTextIntent(e){return(0,n.logMessage)(`Request to analyze text intent of ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,n.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,n.logMessage)(`Request to explain in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async rephraseText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,n.logMessage)(`Request suggest improvements in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,n.logMessage)(`Request to summarize the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE,e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,n.logMessage)(`Request to translate in ${(0,n.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,n.getLanguageNameFromCode)(t)),e)}getHeader(){let e=new Headers;return e.append("Content-Type","application/json"),e}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=JSON.stringify({system_instruction:{parts:{text:e}},contents:{parts:{text:t}},safety_settings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}],generationConfig:{temperature:this.temperature}}),s={method:"POST",headers:this.getHeader(),body:r,redirect:"follow",signal:a},n=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${this.model}:generateContent?key=${this.apiKey}`,s);if(o(),!n.ok){let e=await n.json();throw Error(`Google AI error: ${e.error.message}`)}let g=await n.json();if("SAFETY"==g.candidates[0].finishReason)throw Error(`Google AI error: ${browser.i18n.getMessage("errorGoogleGeminiSafetyThresholdExceeded")}`);return g.candidates[0].content.parts[0].text}}var m=r("hYzqD"),d=r("jYACc"),g=r("ifZGS"),n=r("9v09t");class c extends g.GenericProvider{temperature;apiKey;constructor(e){super(e),this.apiKey=e.mistral.apiKey}async analyzeTextIntent(e){return(0,n.logMessage)(`Request to analyze text intent of ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,n.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,n.logMessage)(`Request to explain in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async rephraseText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,n.logMessage)(`Request suggest improvements in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,n.logMessage)(`Request to summarize in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,n.logMessage)(`Request to translate in ${(0,n.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,n.getLanguageNameFromCode)(t)),e)}getHeader(){let e=new Headers;return e.append("Authorization",`Bearer ${this.apiKey}`),e.append("Accept","application/json"),e.append("Content-Type","application/json"),e}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=JSON.stringify({model:"mistral-large-latest",messages:[{role:"system",content:e},{role:"user",content:t}],temperature:this.temperature}),s={method:"POST",headers:this.getHeader(),body:r,redirect:"follow",signal:a},n=await fetch("https://api.mistral.ai/v1/chat/completions",s);if(o(),!n.ok){let e=await n.json();throw Error(`Mistral AI error: ${e.message??e.detail}`)}return(await n.json()).choices[0].message.content}async moderateText(e){let{signal:t,clearAbortSignalWithTimeout:a}=this.createAbortSignalWithTimeout(this.servicesTimeout),o=JSON.stringify({model:"mistral-moderation-latest",input:e}),r={method:"POST",headers:this.getHeader(),body:o,redirect:"follow",signal:t},s=await fetch("https://api.mistral.ai/v1/moderations",r);if(a(),!s.ok){let e=await s.json();throw Error(`Mistral AI error: ${e.message??e.detail}`)}let n=await s.json();return this.normalizeModerationResponse(n)}normalizeModerationResponse(e){let t=e.results[0].category_scores,a={};for(let e in t)t.hasOwnProperty(e)&&(a[browser.i18n.getMessage(`mailModerate.mistralClassification.${e}`)]=Math.round(100*t[e]));return a}}var h=r("lp4zK"),g=r("ifZGS"),n=r("9v09t");class p extends g.GenericProvider{temperature;apiKey;organizationId;model;text2speechAudioQuality;text2speechVoice;text2speechSpeed;constructor(e){super(e),this.temperature=e.temperature,this.apiKey=e.openai.apiKey,this.organizationId=e.openai.organizationId,this.model=e.openai.model,this.text2speechAudioQuality=e.openai.text2speech.audioQuality,this.text2speechVoice=e.openai.text2speech.voice,this.text2speechSpeed=e.openai.text2speech.speed}async analyzeTextIntent(e){return(0,n.logMessage)(`Request to analyze text intent of ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,n.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,n.logMessage)(`Request to explain in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async getSpeechFromText(e){if((0,n.logMessage)(`Request for text2speech of the text: ${e}`,"debug"),e.length>4096)throw Error("The text is too long, it exceeds the maximum of 4096 characters");let{signal:t,clearAbortSignalWithTimeout:a}=this.createAbortSignalWithTimeout(this.servicesTimeout),o=JSON.stringify({model:this.text2speechAudioQuality,input:e,voice:this.text2speechVoice,speed:this.text2speechSpeed}),r={method:"POST",headers:this.getHeader(),body:o,redirect:"follow",signal:t},s=await fetch("https://api.openai.com/v1/audio/speech",r);if(a(),!s.ok){let e=await s.json();throw Error(`OpenAI error: ${e.error.message}`)}return await s.blob()}async moderateText(e){let{signal:t,clearAbortSignalWithTimeout:a}=this.createAbortSignalWithTimeout(this.servicesTimeout),o=JSON.stringify({model:"omni-moderation-latest",input:e}),r={method:"POST",headers:this.getHeader(),body:o,redirect:"follow",signal:t},s=await fetch("https://api.openai.com/v1/moderations",r);if(a(),!s.ok){let e=await s.json();throw Error(`OpenAI error: ${e.error.message}`)}let n=await s.json();return this.normalizeModerationResponse(n)}async rephraseText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,n.logMessage)(`Request suggest improvements in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,n.logMessage)(`Request to summarize in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,n.logMessage)(`Request to translate in ${(0,n.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,n.getLanguageNameFromCode)(t)),e)}getHeader(){let e=new Headers;return e.append("Authorization",`Bearer ${this.apiKey}`),e.append("Content-Type","application/json"),this.organizationId&&e.append("OpenAI-Organization",this.organizationId),e}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=JSON.stringify({model:this.model,messages:[{role:"system",content:e},{role:"user",content:t}],temperature:this.temperature}),s={method:"POST",headers:this.getHeader(),body:r,redirect:"follow",signal:a},n=await fetch("https://api.openai.com/v1/chat/completions",s);if(o(),!n.ok){let e=await n.json();throw Error(`OpenAI error: ${e.error.message}`)}return(await n.json()).choices[0].message.content}normalizeModerationResponse(e){let t=e.results[0].category_scores,a={};for(let e in t)t.hasOwnProperty(e)&&(a[browser.i18n.getMessage("mailModerate.openaiClassification."+e.replace(/\//g,"_"))]=Math.round(100*t[e]));return a}}var g=r("ifZGS"),n=r("9v09t");class y extends g.GenericProvider{temperature;apiKey;model;constructor(e){super(e),this.temperature=e.temperature,this.apiKey=e.xai.apiKey,this.model=e.xai.model}async analyzeTextIntent(e){return(0,n.logMessage)(`Request to analyze text intent of ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.ANALYZE_INTENT.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async applyCustomPrompt(e,t){return(0,n.logMessage)(`Applying custom user prompt "${e}" to input text: "${t}"`,"debug"),this.manageMessageContent(e,t)}async explainText(e){return(0,n.logMessage)(`Request to explain in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.EXPLAIN.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async rephraseText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to rephrase in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.REPHRASE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async suggestImprovementsForText(e){return(0,n.logMessage)(`Request suggest improvements in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} for the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_IMPROVEMENTS.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async suggestReplyFromText(e,t){return(0,n.logMessage)(`Request to use the tone of voice "${t}" to suggest a reply in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} to the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.SUGGEST_REPLY.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)).replace("%toneOfVoice%",t),e)}async summarizeText(e){return(0,n.logMessage)(`Request to summarize in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)} the text: ${e} in ${(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)}`,"debug"),this.manageMessageContent(this.PROMPTS.SUMMARIZE.replace("%language%",(0,n.getLanguageNameFromCode)(this.mainUserLanguageCode)),e)}async testIntegration(){await this.translateText("Hi!")}async translateText(e,t=null){return t=t??this.mainUserLanguageCode,(0,n.logMessage)(`Request to translate in ${(0,n.getLanguageNameFromCode)(t)} the text: ${e}`,"debug"),this.manageMessageContent(this.PROMPTS.TRANSLATE.replace("%language%",(0,n.getLanguageNameFromCode)(t)),e)}getHeader(){let e=new Headers;return e.append("Authorization",`Bearer ${this.apiKey}`),e.append("Content-Type","application/json"),e}async manageMessageContent(e,t){let{signal:a,clearAbortSignalWithTimeout:o}=this.createAbortSignalWithTimeout(this.servicesTimeout),r=JSON.stringify({model:this.model,messages:[{role:"system",content:e},{role:"user",content:t}],temperature:this.temperature}),s={method:"POST",headers:this.getHeader(),body:r,redirect:"follow",signal:a},n=await fetch("https://api.x.ai/v1/chat/completions",s);if(o(),!n.ok){let e=await n.json();throw Error(`xAI error: ${e.error}`)}return(await n.json()).choices[0].message.content}}const C={anthropic:i,deepseek:u,google:l,groq:m.GroqProvider,lms:d.LmsProvider,mistral:c,ollama:h.OllamaProvider,openai:p,xai:y};class T{static getInstance(e){return new(C[e.llmProvider]||g.GenericProvider)(e)}}function S(e){e&&(document.querySelectorAll("fieldset [required]").forEach(e=>{e.removeAttribute("required")}),document.querySelectorAll(`fieldset#${e} [data-required]`).forEach(e=>{e.setAttribute("required","required")}),document.querySelector("body").setAttribute("data-provider",e))}(0,n.localizeNodes)(),document.querySelector("#llmProvider").addEventListener("change",e=>{S(e.target.value)}),document.querySelector("#llmTemperature").addEventListener("input",e=>{document.querySelector("label[for=llmTemperature] span").innerText=parseFloat(e.currentTarget.value).toFixed(2)}),document.querySelectorAll("#optionsForm input").forEach(e=>{e.addEventListener("input",()=>{document.querySelector("#optionsForm button.test").disabled=!0})}),document.querySelectorAll("#optionsForm select").forEach(e=>{e.addEventListener("change",()=>{document.querySelector("#optionsForm button.test").disabled=!0})}),document.querySelector("#optionsForm button.test").addEventListener("click",async e=>{e.target.disabled=!0,e.target.classList.add("testing");let t=await (0,n.getConfigs)();T.getInstance(t).testIntegration().then(()=>{document.querySelector("#optionsForm #testResult").classList.add("ok"),document.querySelector("#optionsForm #testResult .message").innerHTML=messenger.i18n.getMessage("options.testSuccessful")}).catch(e=>{document.querySelector("#optionsForm #testResult").classList.add("ko"),document.querySelector("#optionsForm #testResult .message").innerHTML=e.message}).finally(()=>{document.querySelector("#optionsForm button.test").classList.remove("testing")})}),document.querySelector("#testResult .close-icon").addEventListener("click",async e=>{document.querySelector("#optionsForm #testResult").classList.remove("ok","ko"),document.querySelector("#optionsForm button.test").disabled=!1}),document.querySelector("#optionsForm").addEventListener("submit",async e=>{if(e.preventDefault(),!e.currentTarget.checkValidity())return void e.currentTarget.classList.add("submit-attempt");let t={mainUserLanguageCode:document.querySelector("#mainUserLanguageCode").value,translationLanguageCodes:document.querySelector("#translationLanguageCodes").getValues(),llmProvider:document.querySelector("#llmProvider").value,temperature:parseFloat(document.querySelector("#llmTemperature").value),servicesTimeout:parseInt(document.querySelector("#servicesTimeout").value),debugMode:document.querySelector("#debugMode").checked,anthropic:{apiKey:document.querySelector("#anthropicApiKey").value,model:document.querySelector("#anthropicModel").value},deepseek:{apiKey:document.querySelector("#deepseekApiKey").value},google:{apiKey:document.querySelector("#googleApiKey").value,model:document.querySelector("#googleModel").value},groq:{apiKey:document.querySelector("#groqApiKey").value,model:document.querySelector("#groqModel").value},lms:{serviceUrl:document.querySelector("#lmsServiceUrl").value,model:document.querySelector("#lmsModel").value},mistral:{apiKey:document.querySelector("#mistralApiKey").value},ollama:{serviceUrl:document.querySelector("#ollamaServiceUrl").value,model:document.querySelector("#ollamaModel").value},openai:{apiKey:document.querySelector("#openaiApiKey").value,organizationId:document.querySelector("#openaiOrganizationId").value,model:document.querySelector("#openaiModel").value,text2speech:{audioQuality:document.querySelector("#openaiText2SpeechAudioQuality").value,voice:document.querySelector("#openaiText2SpeechVoice").value,speed:parseFloat(document.querySelector("#openaiText2SpeechSpeed").value)}},xai:{apiKey:document.querySelector("#xaiApiKey").value,model:document.querySelector("#xaiModel").value}};browser.storage.sync.set(t),document.querySelector("#saveOK").classList.add("show"),setTimeout(()=>{document.querySelector("#saveOK").classList.remove("show")},3e3),document.querySelector("#optionsForm button.test").removeAttribute("disabled"),browser.runtime.sendMessage({type:"optionsChanged"})}),document.addEventListener("DOMContentLoaded",async e=>{let t=await (0,n.getConfigs)(),a=t.llmProvider;document.querySelector("#llmTemperature").value=(t.temperature||1).toString(),document.querySelector("label[for=llmTemperature] span").innerText=parseFloat(document.querySelector("#llmTemperature").value).toFixed(2);let o=browser.i18n.getUILanguage().split("-")[0];document.querySelector("#mainUserLanguageCode").value=t.mainUserLanguageCode||o,document.querySelector("#translationLanguageCodes").setValues(t.translationLanguageCodes||[]),document.querySelector("#llmProvider").value=a,document.querySelector("#servicesTimeout").value=(t.servicesTimeout||12).toString(),document.querySelector("#debugMode").checked=t.debugMode,document.querySelector("#anthropicApiKey").value=t.anthropic?.apiKey||"",document.querySelector("#anthropicModel").value=t.anthropic?.model||"claude-3-haiku-20240307",document.querySelector("#deepseekApiKey").value=t.deepseek?.apiKey||"",document.querySelector("#googleApiKey").value=t.google?.apiKey||"",document.querySelector("#googleModel").value=t.google?.model||"gemini-1.5-flash",document.querySelector("#groqApiKey").value=t.groq?.apiKey||"",document.querySelector("#groqModel").value=t.groq?.model||"",document.querySelector("#lmsServiceUrl").value=t.lms?.serviceUrl||"http://localhost:1234",document.querySelector("#lmsModel").value=t.lms?.model||"",document.querySelector("#mistralApiKey").value=t.mistral?.apiKey||"",document.querySelector("#ollamaServiceUrl").value=t.ollama?.serviceUrl||"http://localhost:11434",document.querySelector("#ollamaModel").value=t.ollama?.model||"",document.querySelector("#openaiApiKey").value=t.openai?.apiKey||"",document.querySelector("#openaiOrganizationId").value=t.openai?.organizationId||"",document.querySelector("#openaiModel").value=t.openai?.model||"gpt-4o-mini",document.querySelector("#openaiText2SpeechAudioQuality").value=t.openai?.text2speech?.audioQuality||"tts-1",document.querySelector("#openaiText2SpeechVoice").value=t.openai?.text2speech?.voice||"onyx",document.querySelector("#openaiText2SpeechVoicePreview audio").setAttribute("src",`https://cdn.openai.com/API/docs/audio/${document.querySelector("#openaiText2SpeechVoice").value}.wav`),document.querySelector("#openaiText2SpeechSpeed").value=(t.openai?.text2speech?.speed||1).toString(),document.querySelector("label[for=openaiText2SpeechSpeed] span").innerText=parseFloat(document.querySelector("#openaiText2SpeechSpeed").value).toFixed(2),document.querySelector("#xaiApiKey").value=t.xai?.apiKey||"",document.querySelector("#xaiModel").value=t.xai?.model||"grok-2-latest",S(a),(await messenger.accounts.list(!1)).some(e=>e.type.endsWith("owl"))&&document.querySelector("#owlForExchangeBug").classList.add("show"),a&&document.querySelector("#optionsForm button.test").removeAttribute("disabled")});